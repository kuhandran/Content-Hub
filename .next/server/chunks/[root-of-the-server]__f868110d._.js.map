{"version":3,"sources":["../../../lib/supabase.js","../../../lib/postgres.js","../../../lib/sync-config.js"],"sourcesContent":["const { createClient } = require('@supabase/supabase-js');\n\nfunction getSupabase() {\n  const url = process.env.SUPABASE_URL || '';\n  const key = process.env.SUPABASE_SERVICE_ROLE_KEY || '';\n  if (!url || !key) {\n    throw new Error('Supabase configuration missing: set SUPABASE_URL and SUPABASE_SERVICE_ROLE_KEY');\n  }\n  return createClient(url, key);\n}\n\nmodule.exports = { getSupabase };\n","// Lightweight Postgres client using DATABASE_URL\n// If DATABASE_URL is not set, this will export null.\n\nconst postgres = require('postgres');\n\nconst connectionString = process.env.DATABASE_URL;\nconst isProd = process.env.NODE_ENV === 'production';\nlet sql = null;\n\nif (connectionString && typeof connectionString === 'string' && connectionString.length > 0) {\n  try {\n    // Enforce SSL in production; prefer in non-prod\n    const sslMode = isProd ? 'require' : 'prefer';\n    // Guard against accidental client-side import\n    if (typeof window !== 'undefined') {\n      throw new Error('Postgres client should not be imported in browser code');\n    }\n    sql = postgres(connectionString, {\n      max: 5,\n      prepare: true,\n      ssl: sslMode,\n    });\n    console.log('[POSTGRES] Client initialized with DATABASE_URL');\n  } catch (err) {\n    console.error('[POSTGRES] Failed to initialize client:', err.message);\n    sql = null;\n  }\n}\n\nmodule.exports = sql;\n","const path = require('path');\n\nconst ALLOWED_EXTENSIONS = [\n  '.json', '.js', '.xml', '.html', '.txt', '.pdf',\n  '.png', '.jpg', '.jpeg', '.gif', '.svg', '.webp', '.docx'\n];\n\nconst IGNORED_DIRS = ['.next', 'node_modules', '.git'];\n\nfunction getPublicDir() {\n  const override = process.env.PUBLIC_DIR;\n  return override && override.trim() ? path.resolve(override) : path.join(process.cwd(), 'public');\n}\n\nfunction getFileExtension(filename) {\n  return path.extname(filename).toLowerCase().slice(1) || 'unknown';\n}\n\nfunction mapFileToTable(filePath) {\n  if (filePath.includes(`${path.sep}collections${path.sep}`)) {\n    return { table: 'collections', fileType: 'json' };\n  }\n  if (filePath.includes(`${path.sep}files${path.sep}`)) {\n    const ext = getFileExtension(filePath);\n    return { table: 'static_files', fileType: ext };\n  }\n  if (filePath.includes(`${path.sep}config${path.sep}`)) {\n    const ext = getFileExtension(filePath);\n    return { table: 'config_files', fileType: ext };\n  }\n  if (filePath.includes(`${path.sep}data${path.sep}`)) {\n    const ext = getFileExtension(filePath);\n    return { table: 'data_files', fileType: ext };\n  }\n  if (filePath.includes(`${path.sep}image${path.sep}`)) {\n    return { table: 'images', fileType: getFileExtension(filePath) };\n  }\n  if (filePath.includes(`${path.sep}js${path.sep}`)) {\n    return { table: 'javascript_files', fileType: 'js' };\n  }\n  if (filePath.includes(`${path.sep}resume${path.sep}`)) {\n    return { table: 'resumes', fileType: getFileExtension(filePath) };\n  }\n  return { table: 'unknown', fileType: getFileExtension(filePath) };\n}\n\nmodule.exports = {\n  ALLOWED_EXTENSIONS,\n  IGNORED_DIRS,\n  getPublicDir,\n  getFileExtension,\n  mapFileToTable,\n};\n"],"names":[],"mappings":"oYAAA,GAAM,CAAE,cAAY,CAAE,CAAA,EAAA,CAAA,CAAA,OAWtB,EAAO,OAAO,CAAG,CAAE,YATnB,SAAS,EACP,IAAM,EAAM,QAAQ,GAAG,CAAC,YAAY,EAAI,GAClC,EAAM,QAAQ,GAAG,CAAC,yBAAyB,EAAI,GACrD,GAAI,CAAC,GAAO,CAAC,EACX,GADgB,GACV,AAAI,MAAM,kFAElB,OAAO,EAAa,EAAK,EAC3B,CAE+B,kBCR/B,IAAM,EAAA,EAAA,CAAA,CAAA,OAEA,EAAmB,QAAQ,GAAG,CAAC,YAAY,CAE7C,EAAM,KAEV,GAAI,GAAgD,UAA5B,OAAO,GAAiC,EAAiB,MAAM,CAAG,EACxF,CAD2F,EACvF,CAOF,EAAM,EAAS,EAAkB,CAC/B,IAAK,EACL,SAAS,EACT,IARuB,CAQlB,QACP,GACA,AAVqC,QAU7B,GAAG,CAAC,kDACd,CAAE,MAAO,EAAK,CACZ,QAAQ,KAAK,CAAC,0CAA2C,EAAI,OAAO,EACpE,EAAM,IACR,CAGF,EAAO,OAAO,CAAG,mhCC7BjB,IAAM,EAAA,EAAA,CAAA,CAAA,OAcN,SAAS,EAAiB,CAAQ,EAChC,OAAO,EAAK,OAAO,CAAC,GAAU,WAAW,GAAG,KAAK,CAAC,IAAM,SAC1D,CA8BA,EAAO,OAAO,CAAG,CACf,mBA7CyB,CACzB,QAAS,MAAO,OAAQ,QAAS,OAAQ,OACzC,OAAQ,OAAQ,QAAS,OAAQ,OAAQ,QAAS,QACnD,CA2CC,aAzCmB,CAAC,QAAS,eAAgB,OAAO,CA0CpD,aAxCF,SAAS,EACP,IAAM,EAAW,QAAQ,GAAG,CAAC,UAAU,CACvC,OAAO,GAAY,EAAS,IAAI,GAAK,EAAK,OAAO,CAAC,GAAY,EAAK,IAAI,CAAC,QAAQ,GAAG,GAAI,SACzF,mBAsCE,EACA,eAjCF,SAAS,AAAe,CAAQ,SAC9B,AAAI,EAAS,QAAQ,CAAC,CAAA,EAAG,EAAK,GAAG,CAAC,WAAW,EAAE,EAAK,GAAG,CAAA,CAAE,EAChD,CADmD,AACjD,MAAO,cAAe,SAAU,MAAO,EAE9C,EAAS,QAAQ,CAAC,CAAA,EAAG,EAAK,GAAG,CAAC,KAAK,EAAE,EAAK,GAAG,CAAA,CAAE,EAE1C,CAF6C,AAE3C,MAAO,eAAgB,SADpB,CAC8B,CADb,EACiB,EAE5C,EAAS,QAAQ,CAAC,CAAA,EAAG,EAAK,GAAG,CAAC,MAAM,EAAE,EAAK,GAAG,CAAA,CAAE,EAE3C,CAF8C,AAE5C,MAAO,eAAgB,SADpB,CAC8B,CADb,EACiB,EAE5C,EAAS,QAAQ,CAAC,CAAA,EAAG,EAAK,GAAG,CAAC,IAAI,EAAE,EAAK,GAAG,CAAA,CAAE,EAEzC,CAF4C,AAE1C,MAAO,aAAc,SADlB,CAC4B,CADX,EACe,EAE1C,EAAS,QAAQ,CAAC,CAAA,EAAG,EAAK,GAAG,CAAC,KAAK,EAAE,EAAK,GAAG,CAAA,CAAE,EAC1C,CAD6C,AAC3C,MAAO,SAAU,SAAU,EAAiB,EAAU,EAE7D,EAAS,QAAQ,CAAC,CAAA,EAAG,EAAK,GAAG,CAAC,EAAE,EAAE,EAAK,GAAG,CAAA,CAAE,EACvC,CAAE,AADwC,MACjC,mBAAoB,SAAU,IAAK,EAEjD,EAAS,QAAQ,CAAC,CAAA,EAAG,EAAK,GAAG,CAAC,MAAM,EAAE,EAAK,GAAG,CAAA,CAAE,EAC3C,CAD8C,AAC5C,MAAO,UAAW,SAAU,EAAiB,EAAU,EAE3D,CAAE,MAAO,UAAW,SAAU,EAAiB,EAAU,CAClE,CAQA"}